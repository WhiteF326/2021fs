<!DOCTYPE HTML>
<html>

<head>
  <meta charset="utf-8" />
  <title> blockly game</title>
  <script src="../blockly/blockly_compressed.js"></script>
  <script src="../blockly/blocks_compressed.js"></script>
  <script src="../blockly/javascript_compressed.js"></script>
  <script src="../blockly/msg/js/en.js"></script>
  <script src="./customblocks.js"></script>
  <style type="text/css">
    body {
      background-color: #fff;
      font-family: sans-serif;
    }

    h1 {
      font-weight: normal;
      font-size: 140%;
    }

    #circle {
      height: 300px;
      width: 300px;
      border-radius: 50%;
      background-color: white;
      border: solid 1px black;
      position: absolute;
      left: 650px;
      top: 100px;
    }
  </style>
</head>

<body>
  <!-- button on run code -->
  <p>
    <button onclick="runCode()"> Run Code</button>
  </p>
  <!-- blockly workspace -->
  <div id="blocklyDiv" style="height:480px;width:600px;"></div>
  <xml id="toolbox" style="display:none;">
    <category name="logic">
      <block type="lightswitch">
      </block>
    </category>
  </xml>
  <!-- added to the page -->
  <div id="circle"></div>

  <script>
    //set options
    var options = {
      toolbox: toolbox,
      collapse: true,
      comments: true,
      disable: true,
      maxBlocks: Infinity,
      trashcan: true,
      horizontalLayout: false,
      toolboxPosition: 'start',
      css: true,
      rtl: false,
      scrollbars: true,
      sounds: true,
      oneBasedIndex: true,
      grid: {
        spacing: 20,
        length: 1,
        colour: '#888',
        snap: true
      }
    }

    //put the toolbox in the workspace
    var workspace = Blockly.inject('blocklyDiv', options);
    // take the text generated by the blocks and run it as code
    function runCode() {
      window.LoopTrap = 1000;
      Blockly.JavaScript.INFINITE_LOOP_TRAP = 'if (--window.LoopTrap == 0) throw "Infinite loop.";Â¥n';
      var code = Blockly.JavaScript.workspaceToCode(workspace);
      Blockly.JavaScript.INFINITE_LOOP_TRAP = null;
      try {
        eval(code);
      } catch (e) {
        alert(e);
      }
    }
  </script>
</body>

</html>